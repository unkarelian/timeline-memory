<div class="rmr-extension-settings">
	<div class="inline-drawer">
		<div class="inline-drawer-toggle inline-drawer-header">
			<b data-i18n="rmr_extension_name">Timeline Memory</b>
			<div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
		</div>
		<div class="inline-drawer-content">
			<h4 data-i18n="rmr_general_settings">General Settings</h4>
			<div class="rmr-extension_block">
				<div class="flex-container" style="gap: 10px; margin-bottom: 10px;">
					<button type="button" class="menu_button" id="rmr_start_tutorial">
						<i class="fa-solid fa-graduation-cap"></i> <span data-i18n="rmr_start_tutorial">Start Tutorial</span>
					</button>
				</div>
				<label class="checkbox_label" for="rmr_tools_enabled">
					<input id="rmr_tools_enabled" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_enable_tools">Enable Tool/Function Calls for Chapter Queries</span>
				</label>
			</div>
			<div class="rmr-extension_block">
				<div class="master-export-import">
					<span class="master-label" data-i18n="rmr_configuration">Configuration:</span>
					<button type="button" class="menu_button" id="rmr_master_export">
						<i class="fa-solid fa-file-export"></i> <span data-i18n="rmr_export_all">Export All</span>
					</button>
					<button type="button" class="menu_button" id="rmr_master_import">
						<i class="fa-solid fa-file-import"></i> <span data-i18n="rmr_import_all">Import All</span>
					</button>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_lore_management">Lore Management</h4>
			<div class="rmr-extension_block">
				<label class="checkbox_label" for="rmr_lore_management_enabled">
					<input id="rmr_lore_management_enabled" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_enable_lore_management">Enable Lore Management Mode</span>
				</label>
			</div>
			<div class="rmr-extension_block">
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_lore_management_profile">
							<small data-i18n="rmr_lore_management_profile">Lore Management Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_lore_management_profile">
							<option value="" data-i18n="rmr_select_profile">-- Select Profile --</option>
						</select>
					</div>
					<div class="flex-container flex0 flexFlowColumn" style="align-items:flex-end;justify-content:flex-end;gap:6px;">
						<button type="button" class="menu_button" id="rmr_run_lore_manage" data-i18n="rmr_run_lore_management">Run Lore Management</button>
					</div>
				</div>
				<div class="flex-container flex1 flexFlowColumn">
					<label for="rmr_lore_management_prompt">
						<small data-i18n="rmr_lore_management_prompt_label">Lore Management Prompt</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_lore_management_placeholder" placeholder="begin lore retrieval" rows="2" class="margin0 text_pole textarea_compact" id="rmr_lore_management_prompt"></textarea>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_agentic_timeline_fill">Agentic Timeline Fill</h4>
			<div class="rmr-extension_block">
				<label class="checkbox_label" for="rmr_agentic_timeline_fill_enabled">
					<input id="rmr_agentic_timeline_fill_enabled" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_enable_agentic_timeline_fill">Enable Agentic Timeline Fill Mode</span>
				</label>
			</div>
			<div class="rmr-extension_block">
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_agentic_timeline_fill_profile">
							<small data-i18n="rmr_agentic_timeline_fill_profile">Agentic Timeline Fill Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_agentic_timeline_fill_profile">
							<option value="" data-i18n="rmr_select_profile">-- Select Profile --</option>
						</select>
					</div>
					<div class="flex-container flex0 flexFlowColumn" style="align-items:flex-end;justify-content:flex-end;gap:6px;">
						<button type="button" class="menu_button" id="rmr_run_agentic_timeline_fill" data-i18n="rmr_run_agentic_timeline_fill">Run Agentic Timeline Fill</button>
					</div>
				</div>
				<div class="flex-container flex1 flexFlowColumn">
					<label for="rmr_agentic_timeline_fill_prompt">
						<small data-i18n="rmr_agentic_timeline_fill_prompt_label">Agentic Timeline Fill Prompt</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_agentic_timeline_fill_placeholder" placeholder="begin timeline retrieval" rows="2" class="margin0 text_pole textarea_compact" id="rmr_agentic_timeline_fill_prompt"></textarea>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_arc_analyzer">Arc Analyzer</h4>
			<div class="rmr-extension_block">
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_arc_profile">
							<small data-i18n="rmr_arc_analyzer_profile">Arc Analyzer Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_arc_profile">
							<option value="" data-i18n="rmr_no_override">-- No Override --</option>
						</select>
					</div>
					<div class="flex-container flex0 flexFlowColumn" style="align-items:flex-end;justify-content:flex-end;gap:6px;">
						<button type="button" class="menu_button" id="rmr_run_arc_analyzer" data-i18n="rmr_analyze_arcs">Analyze Arcs</button>
					</div>
				</div>

				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_arc_preset">
							<small data-i18n="rmr_arc_analyzer_preset">Arc Analyzer Preset</small>
						</label>
						<div class="preset-row">
							<select class="text_pole widthNatural" id="rmr_arc_preset">
								<option value="" data-i18n="rmr_custom">-- Custom --</option>
							</select>
							<div class="preset-buttons">
								<button type="button" class="menu_button" id="rmr_save_arc_preset" data-i18n="rmr_save">Save</button>
								<button type="button" class="menu_button" id="rmr_update_arc_preset" data-i18n="rmr_update">Update</button>
								<button type="button" class="menu_button" id="rmr_delete_arc_preset" data-i18n="rmr_delete">Delete</button>
							</div>
							<div class="preset-import-export">
								<button type="button" class="menu_button small" id="rmr_export_arc_preset" data-i18n="rmr_export">Export</button>
								<button type="button" class="menu_button small" id="rmr_import_arc_preset" data-i18n="rmr_import">Import</button>
							</div>
						</div>
					</div>
				</div>

				<div class="rmr-extension_block flex-container flexFlowColumn">
					<div title="System prompt for arc analysis." class="flex-container flex1 flexFlowColumn">
						<label for="rmr_arc_analyzer_system_prompt">
							<small data-i18n="rmr_arc_system_prompt">Arc Analyzer System Prompt</small>
						</label>
						<textarea data-i18n="[placeholder]rmr_arc_system_placeholder" placeholder="System-level instructions for arc analysis (optional)" rows="2" class="margin0 text_pole textarea_compact" id="rmr_arc_analyzer_system_prompt"></textarea>
					</div>
					<div title="The prompt used to analyze the chat for arcs. Supports {{chapterHistory}}." class="flex-container flex1 flexFlowColumn">
						<label for="rmr_arc_analyzer_prompt_template">
							<small data-i18n="rmr_arc_user_prompt">Arc Analyzer User Prompt</small>
						</label>
						<textarea placeholder="" rows="6" class="margin0 text_pole textarea_compact" id="rmr_arc_analyzer_prompt_template"></textarea>
					</div>
				</div>
			<hr>
			<h4 data-i18n="rmr_message_buttons">Message Buttons</h4>
			<div class="rmr-extension_block">
				<label class="checkbox_label" for="rmr_chapter_button">
					<span class="rmr-button fa-solid fa-fw fa-circle-stop"></span>
					<input id="rmr_chapter_button" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_end_chapter">End Chapter</span>
				</label>
			</div>
			<hr>
			<h4><i class="fa-solid fa-book"></i> <span data-i18n="rmr_summaries">Summaries</span></h4>
			<div class="rmr-extension_block">
				<div id="rmr_summaries_container" class="rmr-summaries-container">
					<div class="rmr-summaries-empty" data-i18n="rmr_no_chapters">No chapters in current chat. End a chapter to create a summary.</div>
				</div>
			</div>
			<!-- Fullscreen Summary Popup -->
			<div id="rmr_summary_popup" class="rmr-summary-popup-overlay" style="display: none;">
				<div class="rmr-summary-popup">
					<div class="rmr-summary-popup-header">
						<span class="rmr-summary-popup-title"><span data-i18n="rmr_chapter">Chapter</span> <span id="rmr_popup_chapter_num"></span></span>
						<span class="rmr-summary-popup-range" id="rmr_popup_range"></span>
						<button type="button" class="rmr-summary-popup-close" id="rmr_popup_close">
							<i class="fa-solid fa-xmark"></i>
						</button>
					</div>
					<div class="rmr-summary-popup-body">
						<textarea id="rmr_popup_textarea" class="rmr-summary-popup-textarea text_pole" data-i18n="[placeholder]rmr_enter_summary" placeholder="Enter chapter summary..."></textarea>
					</div>
					<div class="rmr-summary-popup-footer">
						<button type="button" class="menu_button rmr-popup-remove-btn" id="rmr_popup_remove" style="display: none;" data-i18n="rmr_remove">Remove</button>
						<div class="rmr-summary-popup-spacer"></div>
						<button type="button" class="menu_button" id="rmr_popup_resummarize" data-i18n="rmr_resummarize">Resummarize</button>
						<button type="button" class="menu_button" id="rmr_popup_cancel" data-i18n="rmr_cancel">Cancel</button>
						<button type="button" class="menu_button" id="rmr_popup_save" disabled data-i18n="rmr_save">Save</button>
					</div>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_api_profiles">API Connection Profiles</h4>
			<div class="rmr-extension_block">
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_profile">
							<small data-i18n="rmr_summarization_profile">Summarization Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_profile">
							<option value="" data-i18n="rmr_no_override">-- No Override --</option>
						</select>
					</div>
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_query_profile">
							<small data-i18n="rmr_chapter_query_profile">Chapter Query Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_query_profile">
						</select>
					</div>
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_timeline_fill_profile">
							<small data-i18n="rmr_timeline_fill_profile">Timeline Fill Profile</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_timeline_fill_profile">
							<option value="" data-i18n="rmr_no_override">-- No Override --</option>
						</select>
					</div>
				</div>
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_rate_limit">
							<small data-i18n="rmr_max_requests">Max Requests per Minute</small>
						</label>
						<input class="text_pole widthNatural" id="rmr_rate_limit" type="number">
					</div>
					<div class="flex-container flex1 flexFlowColumn" title="Maximum number of chapters that can be queried at once. Set to 0 for unlimited.">
						<label for="rmr_query_chapter_limit">
							<small data-i18n="rmr_max_chapters_query">Max Chapters per Query</small>
						</label>
						<input class="text_pole widthNatural" id="rmr_query_chapter_limit" type="number" min="0">
					</div>
					<div class="flex-container flex1 flexFlowColumn" title="Maximum number of queries a timeline fill can make. Set to 0 for unlimited.">
						<label for="rmr_timeline_fill_query_limit">
							<small data-i18n="rmr_max_timeline_queries">Max Timeline Fill Queries</small>
						</label>
						<input class="text_pole widthNatural" id="rmr_timeline_fill_query_limit" type="number" min="0">
					</div>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_presets">Presets</h4>
			<div class="rmr-extension_block">
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_summarize_preset">
							<small data-i18n="rmr_summarization_preset">Summarization Preset</small>
						</label>
						<div class="preset-row">
							<select class="text_pole widthNatural" id="rmr_summarize_preset">
								<option value="" data-i18n="rmr_custom">-- Custom --</option>
							</select>
							<div class="preset-buttons">
								<button type="button" class="menu_button" id="rmr_save_summarize_preset" data-i18n="rmr_save">Save</button>
								<button type="button" class="menu_button" id="rmr_update_summarize_preset" data-i18n="rmr_update">Update</button>
								<button type="button" class="menu_button" id="rmr_delete_summarize_preset" data-i18n="rmr_delete">Delete</button>
							</div>
							<div class="preset-import-export">
								<button type="button" class="menu_button small" id="rmr_export_summarize_preset" data-i18n="rmr_export">Export</button>
								<button type="button" class="menu_button small" id="rmr_import_summarize_preset" data-i18n="rmr_import">Import</button>
							</div>
						</div>
					</div>
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_query_preset">
							<small data-i18n="rmr_query_preset">Query Preset</small>
						</label>
						<div class="preset-row">
							<select class="text_pole widthNatural" id="rmr_query_preset">
								<option value="" data-i18n="rmr_custom">-- Custom --</option>
							</select>
							<div class="preset-buttons">
								<button type="button" class="menu_button" id="rmr_save_query_preset" data-i18n="rmr_save">Save</button>
								<button type="button" class="menu_button" id="rmr_update_query_preset" data-i18n="rmr_update">Update</button>
								<button type="button" class="menu_button" id="rmr_delete_query_preset" data-i18n="rmr_delete">Delete</button>
							</div>
							<div class="preset-import-export">
								<button type="button" class="menu_button small" id="rmr_export_query_preset" data-i18n="rmr_export">Export</button>
								<button type="button" class="menu_button small" id="rmr_import_query_preset" data-i18n="rmr_import">Import</button>
							</div>
						</div>
					</div>
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_timeline_fill_preset">
							<small data-i18n="rmr_timeline_fill_preset">Timeline Fill Preset</small>
						</label>
						<div class="preset-row">
							<select class="text_pole widthNatural" id="rmr_timeline_fill_preset">
								<option value="" data-i18n="rmr_custom">-- Custom --</option>
							</select>
							<div class="preset-buttons">
								<button type="button" class="menu_button" id="rmr_save_timeline_fill_preset" data-i18n="rmr_save">Save</button>
								<button type="button" class="menu_button" id="rmr_update_timeline_fill_preset" data-i18n="rmr_update">Update</button>
								<button type="button" class="menu_button" id="rmr_delete_timeline_fill_preset" data-i18n="rmr_delete">Delete</button>
							</div>
							<div class="preset-import-export">
								<button type="button" class="menu_button small" id="rmr_export_timeline_fill_preset" data-i18n="rmr_export">Export</button>
								<button type="button" class="menu_button small" id="rmr_import_timeline_fill_preset" data-i18n="rmr_import">Import</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_prompts">Prompts</h4>
			<div class="rmr-extension_block flex-container flexFlowColumn">
				<div title="System prompt for chapter summarization." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_memory_system_prompt">
						<small data-i18n="rmr_chapter_summary_system">Chapter Summary System Prompt</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_summary_system_placeholder" placeholder="System-level instructions for summarization (optional)" rows="2" class="margin0 text_pole textarea_compact" id="rmr_memory_system_prompt"></textarea>
				</div>
				<div title="The prompt appended to a section of message history when generating a summary." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_memory_prompt_template">
						<small data-i18n="rmr_chapter_summary_user">Chapter Summary User Prompt</small>
					</label>
					<textarea placeholder="" rows="5" class="margin0 text_pole textarea_compact" id="rmr_memory_prompt_template"></textarea>
				</div>
				<hr class="sysHR">
				<div title="System prompt for chapter queries." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_chapter_query_system_prompt">
						<small data-i18n="rmr_chapter_query_system">Chapter Query System Prompt</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_query_system_placeholder" placeholder="System-level instructions for chapter queries (optional)" rows="2" class="margin0 text_pole textarea_compact" id="rmr_chapter_query_system_prompt"></textarea>
				</div>
				<div title="The prompt used when querying a specific chapter with a question." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_chapter_query_prompt_template">
						<small data-i18n="rmr_chapter_query_user">Chapter Query User Prompt</small>
					</label>
					<textarea placeholder="" rows="5" class="margin0 text_pole textarea_compact" id="rmr_chapter_query_prompt_template"></textarea>
				</div>
				<hr class="sysHR">
				<div title="System prompt for timeline fill generation." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_timeline_fill_system_prompt">
						<small data-i18n="rmr_timeline_fill_system">Timeline Fill System Prompt</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_timeline_fill_system_placeholder" placeholder="System-level instructions for timeline fill (optional)" rows="2" class="margin0 text_pole textarea_compact" id="rmr_timeline_fill_system_prompt"></textarea>
				</div>
				<div title="The prompt the assistant should follow to propose timeline queries in JSON format." class="flex-container flex1 flexFlowColumn">
					<label for="rmr_timeline_fill_prompt_template">
						<small data-i18n="rmr_timeline_fill_user">Timeline Fill User Prompt</small>
					</label>
					<textarea placeholder="" rows="5" class="margin0 text_pole textarea_compact" id="rmr_timeline_fill_prompt_template"></textarea>
				</div>
			</div>
			<hr>
			<h4 data-i18n="rmr_chapter_settings">Chapter Settings</h4>
			<div class="rmr-extension_block">
				<label class="checkbox_label" for="rmr_hide_chapter">
					<input id="rmr_hide_chapter" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_hide_summarized">Hide Summarized Messages</span>
				</label>
				<label class="checkbox_label" for="rmr_add_chunk_summaries">
					<input id="rmr_add_chunk_summaries" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_add_chunk_summaries">Add chunk summaries (when there are more than one) as comment</span>
				</label>
			</div>
			<hr>
			<h4 data-i18n="rmr_inject_at_depth">Inject at Depth</h4>
			<div class="rmr-extension_block">
				<label class="checkbox_label" for="rmr_inject_enabled">
					<input id="rmr_inject_enabled" class="checkbox" type="checkbox" />
					<span data-i18n="rmr_enable_injection">Enable Timeline Injection</span>
				</label>
				<div class="flex-container marginTopBot5">
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_inject_depth">
							<small data-i18n="rmr_injection_depth">Injection Depth</small>
						</label>
						<input class="text_pole widthUnset" id="rmr_inject_depth" type="number" min="0" max="999" value="0" />
					</div>
					<div class="flex-container flex1 flexFlowColumn">
						<label for="rmr_inject_role">
							<small data-i18n="rmr_injection_role">Injection Role</small>
						</label>
						<select class="text_pole widthNatural" id="rmr_inject_role">
						</select>
					</div>
				</div>
				<div class="flex-container flex1 flexFlowColumn marginTopBot5">
					<label for="rmr_inject_prompt">
						<small data-i18n="rmr_injection_prompt">Injection Prompt Template</small>
					</label>
					<textarea data-i18n="[placeholder]rmr_injection_placeholder" placeholder="Prompt to inject at depth..." rows="8" class="margin0 text_pole textarea_compact" id="rmr_inject_prompt"></textarea>
				</div>
			</div>
			<hr>
		</div>
	</div>
</div>

<style>
.preset-row {
	display: flex;
	flex-direction: column;
	gap: 5px;
}

.preset-buttons {
	display: flex;
	gap: 5px;
	margin-top: 5px;
}

.preset-buttons button {
	font-size: 12px;
	padding: 4px 8px;
}

.preset-buttons button:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.rmr-extension_block select.text_pole {
	margin-bottom: 5px;
}

.preset-import-export {
	display: flex;
	gap: 5px;
	margin-top: 5px;
}

.preset-import-export .menu_button.small {
	font-size: 11px;
	padding: 3px 6px;
}

.master-export-import {
	display: flex;
	align-items: center;
	gap: 10px;
	margin-top: 5px;
}

.master-export-import .master-label {
	font-weight: 500;
}

.master-export-import .menu_button {
	display: flex;
	align-items: center;
	gap: 5px;
}

/* Summaries list styles */
.rmr-summaries-container {
	max-height: 400px;
	overflow-y: auto;
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.rmr-summaries-empty {
	color: var(--SmartThemeQuoteColor);
	font-style: italic;
	padding: 10px;
	text-align: center;
}

.rmr-summary-item {
	border: 1px solid var(--SmartThemeBorderColor);
	border-radius: 4px;
	padding: 8px;
	background: var(--SmartThemeBlurTintColor);
}

.rmr-summary-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 6px;
	font-weight: 500;
	color: var(--SmartThemeEmColor);
}

.rmr-summary-range {
	font-size: 11px;
	color: var(--SmartThemeQuoteColor);
	font-weight: normal;
}

.rmr-summary-text {
	width: 100%;
	min-height: 60px;
	resize: vertical;
	font-size: 12px;
}

.rmr-summary-actions {
	display: flex;
	justify-content: flex-end;
	gap: 5px;
	margin-top: 6px;
}

.rmr-summary-actions .menu_button {
	font-size: 11px;
	padding: 3px 8px;
}

.rmr-summary-actions .menu_button:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.rmr-summary-actions .rmr-remove-summary {
	background-color: #c0392b;
	color: white;
	opacity: 0.85;
}

.rmr-summary-actions .rmr-remove-summary:hover {
	opacity: 1;
	background-color: #e74c3c;
}

.rmr-summary-expand {
	background: none;
	border: none;
	color: var(--SmartThemeBodyColor);
	cursor: pointer;
	padding: 2px 6px;
	opacity: 0.7;
	transition: opacity 0.2s;
}

.rmr-summary-expand:hover {
	opacity: 1;
}

/* Fullscreen popup styles */
.rmr-summary-popup-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 9999;
}

.rmr-summary-popup {
	background: var(--SmartThemeBlurTintColor);
	border: 1px solid var(--SmartThemeBorderColor);
	border-radius: 8px;
	width: 80%;
	max-width: 800px;
	max-height: 80vh;
	display: flex;
	flex-direction: column;
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.rmr-summary-popup-header {
	display: flex;
	align-items: center;
	padding: 12px 16px;
	border-bottom: 1px solid var(--SmartThemeBorderColor);
	gap: 12px;
}

.rmr-summary-popup-title {
	font-weight: 600;
	font-size: 16px;
	color: var(--SmartThemeEmColor);
}

.rmr-summary-popup-range {
	font-size: 12px;
	color: var(--SmartThemeQuoteColor);
	flex: 1;
}

.rmr-summary-popup-close {
	background: none;
	border: none;
	color: var(--SmartThemeBodyColor);
	cursor: pointer;
	padding: 4px 8px;
	font-size: 18px;
	opacity: 0.7;
	transition: opacity 0.2s;
}

.rmr-summary-popup-close:hover {
	opacity: 1;
}

.rmr-summary-popup-body {
	flex: 1;
	padding: 16px;
	overflow: hidden;
	display: flex;
	flex-direction: column;
}

.rmr-summary-popup-textarea {
	flex: 1;
	width: 100%;
	min-height: 300px;
	resize: vertical;
	font-size: 14px;
	line-height: 1.5;
}

.rmr-summary-popup-footer {
	display: flex;
	justify-content: flex-end;
	gap: 10px;
	padding: 12px 16px;
	border-top: 1px solid var(--SmartThemeBorderColor);
}

.rmr-summary-popup-footer .menu_button {
	padding: 6px 16px;
}

.rmr-summary-popup-spacer {
	flex: 1;
}

.rmr-popup-remove-btn {
	background-color: var(--SmartThemeQuoteColor);
	opacity: 0.8;
}

.rmr-popup-remove-btn:hover {
	opacity: 1;
	background-color: #c0392b;
}

/* Arc Analyzer Popup Styles */
.rmr-arc-popup-overlay {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	width: 100%;
	height: 100%;
	min-height: 100vh;
	min-height: 100dvh;
	background: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 9999;
	overflow: auto;
	padding: 20px;
	box-sizing: border-box;
}

.rmr-arc-popup {
	background: var(--SmartThemeBlurTintColor);
	border: 1px solid var(--SmartThemeBorderColor);
	border-radius: 8px;
	width: 90%;
	max-width: 700px;
	max-height: 80vh;
	display: flex;
	flex-direction: column;
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
	position: relative;
	transition: opacity 0.2s;
}

.rmr-arc-popup.loading {
	pointer-events: none;
}

.rmr-arc-popup.loading .rmr-arc-popup-body {
	opacity: 0.4;
}

.rmr-arc-popup-header {
	display: flex;
	align-items: center;
	padding: 12px 16px;
	border-bottom: 1px solid var(--SmartThemeBorderColor);
	gap: 12px;
	flex-wrap: wrap;
}

.rmr-arc-popup-title {
	font-weight: 600;
	font-size: 16px;
	color: var(--SmartThemeEmColor);
}

.rmr-arc-popup-position {
	font-size: 12px;
	color: var(--SmartThemeQuoteColor);
	flex: 1;
}

.rmr-arc-popup-position strong {
	color: var(--SmartThemeEmColor);
}

.rmr-arc-popup-close {
	background: none;
	border: none;
	color: var(--SmartThemeBodyColor);
	cursor: pointer;
	padding: 4px 8px;
	font-size: 18px;
	opacity: 0.7;
	transition: opacity 0.2s;
}

.rmr-arc-popup-close:hover {
	opacity: 1;
}

.rmr-arc-popup-actions {
	display: flex;
	align-items: center;
	gap: 8px;
	margin-left: auto;
}

.rmr-arc-reanalyze-btn {
	display: flex;
	align-items: center;
	gap: 6px;
	padding: 4px 10px;
	font-size: 12px;
	opacity: 0.9;
}

.rmr-arc-reanalyze-btn:hover {
	opacity: 1;
}

.rmr-arc-reanalyze-btn i {
	font-size: 11px;
}

.rmr-arc-popup-body {
	flex: 1;
	padding: 16px;
	overflow-y: auto;
	transition: opacity 0.2s;
}

.rmr-arc-list {
	display: flex;
	flex-direction: column;
	gap: 12px;
}

.rmr-arc-item {
	border: 1px solid var(--SmartThemeBorderColor);
	border-radius: 6px;
	padding: 12px;
	background: var(--SmartThemeBlurTintColor);
	transition: opacity 0.2s, border-color 0.2s;
}

.rmr-arc-item.completed {
	opacity: 0.6;
	border-color: var(--SmartThemeQuoteColor);
}

.rmr-arc-item-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 8px;
	flex-wrap: wrap;
	gap: 8px;
}

.rmr-arc-item-title {
	font-weight: 600;
	font-size: 14px;
	color: var(--SmartThemeEmColor);
}

.rmr-arc-item-meta {
	font-size: 12px;
	color: var(--SmartThemeQuoteColor);
}

.rmr-arc-item-meta strong {
	color: var(--SmartThemeEmColor);
}

.rmr-arc-item-summary {
	font-size: 13px;
	color: var(--SmartThemeBodyColor);
	margin-bottom: 6px;
	line-height: 1.4;
}

.rmr-arc-item-justification {
	font-size: 12px;
	color: var(--SmartThemeQuoteColor);
	margin-bottom: 10px;
}

.rmr-arc-item-btn {
	font-size: 12px;
	padding: 6px 12px;
}

.rmr-arc-item-btn:disabled {
	opacity: 0.6;
	cursor: not-allowed;
}

/* Loading overlay */
.rmr-arc-popup-loading {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	display: none;
	flex-direction: column;
	align-items: center;
	gap: 12px;
	padding: 24px;
	background: var(--SmartThemeBlurTintColor);
	border: 1px solid var(--SmartThemeBorderColor);
	border-radius: 8px;
	box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
	z-index: 10;
}

.rmr-arc-popup-loading.active {
	display: flex;
}

.rmr-arc-popup-loading span {
	font-size: 14px;
	color: var(--SmartThemeEmColor);
}

.rmr-arc-popup-loading i.fa-gear {
	font-size: 32px;
	color: var(--SmartThemeEmColor);
}

/* Arc item animations */
.rmr-arc-item.fade-out {
	animation: arcFadeOut 0.2s ease-out forwards;
}

.rmr-arc-item.fade-in {
	animation: arcFadeIn 0.3s ease-out forwards;
	opacity: 0;
}

@keyframes arcFadeOut {
	from {
		opacity: 1;
		transform: translateY(0);
	}
	to {
		opacity: 0;
		transform: translateY(-10px);
	}
}

@keyframes arcFadeIn {
	from {
		opacity: 0;
		transform: translateY(10px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

/* Empty state message */
.rmr-arc-empty {
	text-align: center;
	padding: 24px;
	color: var(--SmartThemeQuoteColor);
	font-style: italic;
}

.rmr-arc-empty.fade-in {
	animation: arcFadeIn 0.3s ease-out forwards;
	opacity: 0;
}

/* Re-analyze button disabled state */
.rmr-arc-reanalyze-btn:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* Mobile responsive styles for Arc Analyzer Popup */
@media (max-width: 768px) {
	.rmr-arc-popup-overlay {
		padding: 10px;
		align-items: flex-start;
		padding-top: 5vh;
	}

	.rmr-arc-popup {
		width: 100%;
		max-width: none;
		max-height: 85vh;
		margin: 0 auto;
		border-radius: 12px;
		flex-shrink: 0;
	}

	.rmr-arc-popup-header {
		padding: 10px 12px;
		gap: 8px;
		flex-direction: column;
		align-items: flex-start;
	}

	.rmr-arc-popup-title {
		font-size: 18px;
		order: 1;
	}

	.rmr-arc-popup-position {
		font-size: 11px;
		order: 2;
		flex: none;
		width: 100%;
	}

	.rmr-arc-popup-close {
		position: absolute;
		top: 8px;
		right: 4px;
		font-size: 24px;
		padding: 8px 14px;
		z-index: 5;
	}

	.rmr-arc-popup-actions {
		position: absolute;
		top: 44px;
		left: 12px;
		right: auto;
		margin-left: 0;
	}

	.rmr-arc-reanalyze-btn {
		padding: 6px 10px;
		font-size: 11px;
	}

	.rmr-arc-popup-body {
		padding: 12px;
	}

	.rmr-arc-list {
		gap: 10px;
	}

	.rmr-arc-item {
		padding: 10px;
	}

	.rmr-arc-item-header {
		flex-direction: column;
		align-items: flex-start;
		gap: 4px;
	}

	.rmr-arc-item-title {
		font-size: 15px;
	}

	.rmr-arc-item-meta {
		font-size: 11px;
	}

	.rmr-arc-item-summary {
		font-size: 13px;
		line-height: 1.5;
	}

	.rmr-arc-item-justification {
		font-size: 11px;
	}

	.rmr-arc-item-btn {
		width: 100%;
		padding: 10px 16px;
		font-size: 14px;
		margin-top: 8px;
	}

	.rmr-arc-popup-loading {
		padding: 20px;
		width: 80%;
		max-width: 250px;
	}

	.rmr-arc-popup-loading i.fa-gear {
		font-size: 28px;
	}

	.rmr-arc-popup-loading span {
		font-size: 13px;
		text-align: center;
	}
}

/* Extra small screens */
@media (max-width: 400px) {
	.rmr-arc-popup-overlay {
		padding: 0;
		padding-top: 0;
		align-items: flex-start;
	}

	.rmr-arc-popup {
		width: 100%;
		height: 100%;
		max-height: 100%;
		margin: 0;
		border-radius: 0;
	}

	.rmr-arc-popup-header {
		padding: 12px;
		padding-right: 50px;
	}

	.rmr-arc-popup-position {
		font-size: 10px;
	}
}
</style>
